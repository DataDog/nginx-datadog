#!/bin/bash
set -ex

RESTY_VERSION="1.25.3.2"
RESTY_OPENSSL_VERSION="1.1.1w"
RESTY_OPENSSL_PATCH_VERSION="1.1.1f"
RESTY_PCRE_VERSION="8.45"
RESTY_PCRE_BUILD_OPTIONS="--enable-jit"
RESTY_PCRE_SHA256="4e6ce03e0336e8b4a3d6c2b70b1c5e18590a5673a98186da90d4f33c23defc09"
RESTY_J="8"

docker build \
    --build-arg RESTY_VERSION=${RESTY_VERSION} \
    --build-arg RESTY_OPENSSL_VERSION=${RESTY_OPENSSL_VERSION} \
    --build-arg RESTY_OPENSSL_PATCH_VERSION=${RESTY_OPENSSL_PATCH_VERSION} \
    --build-arg RESTY_PCRE_VERSION=${RESTY_PCRE_VERSION} \
    --build-arg RESTY_PCRE_BUILD_OPTIONS=${RESTY_PCRE_BUILD_OPTIONS} \
    --build-arg RESTY_PCRE_SHA256=${RESTY_PCRE_SHA256} \
    --build-arg RESTY_J=${RESTY_J} \
    -t louis/base-test \
    .