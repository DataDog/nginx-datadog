version: 2.1

jobs:
  build:
    parameters:
      # `build-image` is the docker image, with tag, in which the module will
      # be built. It's of the form
      # "datadog/docker-library:nginx-datadog-build-$base_image_without_colons".
      build-image:
        type: string
      # `base-image` is the docker image on which the build-image is based.
      # This parameter is extracted from nginx-version-info by the release
      # script, so that it knows how to name the built shared object.
      base-image:
        type: string
        default: ""
      # `nginx-version` is the release version of the nginx source code to
      # include in the built module. It's of the form
      # "$major.$minor.$patch".
      nginx-version:
        type: string
    docker:
    - image:  << parameters.build-image >>
    resource_class: xlarge
    environment:
      # The `resource_class` implies a memory limit and supposedly a CPU count
      # limit.  However, either there is no actual CPU count limit, or the
      # limit cannot be determined from within the running job.
      # Instead, the number of CPUs on the host machine is all we can see.
      # This means that a command like `make --jobs=$(nproc)` is likely to run
      # out of memory, because while the `resource_class` says it has 2 CPUs,
      # `nproc` will report something like 36.  `make` will then spawn a bunch
      # of processes, and the job will run out of memory.
      # So, here we hard-code the number of CPUs supposedly offered by the
      # `resource_class`.  For information about the `resource_class` values,
      # see:
      # https://circleci.com/docs/2.0/configuration-reference/
      MAKE_JOB_COUNT: 8
    steps:
    - checkout
    - run: printf 'NGINX_VERSION=%s\n' << parameters.nginx-version >> >>nginx-version-info
    - run: printf 'BASE_IMAGE=%s\n' '<< parameters.base-image >>' >>nginx-version-info
    - run: make build
    - persist_to_workspace:
        root: .
        paths:
          - .build/libngx_http_datadog_module.so
          - nginx-version-info
    - store_artifacts:
        path: .build/libngx_http_datadog_module.so
        destination: ngx_http_datadog_module.so
    - store_artifacts:
        path: nginx-version-info
        destination: nginx-version-info

  test:
    parameters:
      # `base-image` is the docker image on top of which the test image will be
      # built. This determines the particular nginx under test.
      base-image:
        type: string
        default: ""
      # `nginx-modules-path` is the file system path of a directory where nginx
      # looks for modules. It is not, surprisingly, always consistent with the
      # `--modules-path` argument to nginx's `./configure` script.
      nginx-modules-path:
        type: string
        default: ""
      # `nginx-conf-path` is the file system path to nginx's configuration file.
      nginx-conf-path:
        type: string
        default: ""
    docker:
    # "cimg" means "convenience image."  Helpful images provided by CircleCI.
    # This one contains Python, docker-compose, and a bunch of other things.
    # See https://circleci.com/docs/circleci-images
    - image: cimg/python:3.10.5
    environment:
      # See https://github.com/containers/podman/issues/13889
      DOCKER_BUILDKIT: 0
    steps:
    - checkout
    - attach_workspace:
        at: /tmp/workspace
    - run: mv /tmp/workspace/nginx-version-info .
    - run: printf 'NGINX_MODULES_PATH=%s\n' '<< parameters.nginx-modules-path >>' >>nginx-version-info
    - run: printf 'NGINX_CONF_PATH=%s\n' '<< parameters.nginx-conf-path >>' >>nginx-version-info
    - run: mv /tmp/workspace/.build/libngx_http_datadog_module.so test/services/nginx/ngx_http_datadog_module.so
    - setup_remote_docker:
        # Cache docker layers somewhere so that we don't have to rebuild test
        # service images every time.
        docker_layer_caching: true
    - run: |
        env | sort
    # Instead of just running the tests, we run the tests and note whether they
    # succeeded.  This way, we can save the verbose output afterward and then
    # fail if the tests didn't succeed.
    # TODO: This sucks, though.  Find a better way.  The output of a failed test
    # runner should be red in the CI interface.
    - run: |
        if test/bin/run --verbose --failfast; then
          touch .tests-succeeded
        fi
    - store_artifacts:
        path: test/logs/test.log
        destination: test.log
    - run: |
        if ! [ -f .tests-succeeded ]; then
          cat test/logs/test.log
          printf '\n\nTests failed.  See the test run step for test driver output.  Verbose output is above.\n'
          exit 1
        fi

  example:
    parameters:
      # `base-image` is the docker image on top of which the example nginx image
      # will be built. The corresponding nginx-datadog release will be
      # downloaded from GitHub and installed.
      base-image:
        type: string
        default: ""
      # `nginx-modules-path` is the file system path of a directory where nginx
      # looks for modules. It is not, surprisingly, always consistent with the
      # `--modules-path` argument to nginx's `./configure` script.
      nginx-modules-path:
        type: string
        default: ""
      # `nginx-conf-path` is the file system path to nginx's configuration file.
      nginx-conf-path:
        type: string
        default: ""
    docker:
    # "cimg" means "convenience image."  Helpful images provided by CircleCI.
    # This one docker-compose and a bunch of other things.
    # See https://circleci.com/docs/circleci-images
    - image: cimg/base:current
    environment:
      # See https://github.com/containers/podman/issues/13889
      DOCKER_BUILDKIT: 0
      BASE_IMAGE: << parameters.base-image >>
      NGINX_MODULES_PATH: << parameters.nginx-modules-path >>
      NGINX_CONF_PATH: << parameters.nginx-conf-path >>
      DD_API_KEY: this-is-a-bogus-api-key
    steps:
    - checkout
    - setup_remote_docker:
        # Cache docker layers somewhere so that we don't have to rebuild test
        # service images every time.
        docker_layer_caching: true
    - run:
        working_directory: ~/project/example
        command: docker-compose up --build --detach
    - run: 'echo "sleeping for a bit to let the services come up..."; sleep 30'
    - run:
        working_directory: ~/project/example
        command: bin/check

  shellcheck:
    docker:
    - image: koalaman/shellcheck-alpine:stable
      entrypoint: /bin/sh
    steps:
    - checkout
    - run: find bin/ test/ example/ -type f -executable | xargs shellcheck --exclude SC1071,SC1091,SC2317

workflows:
  build-and-test-all:
    jobs:
    - shellcheck:
        name: "run shellcheck on shell scripts"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
    # Running the example doesn't tell us anything about the proposed pull
    # request or candidate release, but it's here as a check to break should any
    # changes break the example.
    - example:
        name: "run the example on Amazon Linux"
        base-image: "amazonlinux:2.0.20230119.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
    - example:
        name: "run the example on Debian"
        base-image: "nginx:1.23.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
    - example:
        name: "run the example on Alpine"
        base-image: "nginx:1.23.2-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
    # The following are generated by `../bin/generate_jobs_yaml.sh`.
    - build:
        name: "build on amazonlinux:2.0.20230418.0"
        base-image: "amazonlinux:2.0.20230418.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20230418.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
    - test:
        name: "test on amazonlinux:2.0.20230418.0"
        base-image: "amazonlinux:2.0.20230418.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20230418.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
    - build:
        name: "build on amazonlinux:2.0.20230320.0"
        base-image: "amazonlinux:2.0.20230320.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20230320.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20230320.0"
        base-image: "amazonlinux:2.0.20230320.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20230320.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20230307.0"
        base-image: "amazonlinux:2.0.20230307.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20230307.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20230307.0"
        base-image: "amazonlinux:2.0.20230307.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20230307.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20230221.0"
        base-image: "amazonlinux:2.0.20230221.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20230221.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20230221.0"
        base-image: "amazonlinux:2.0.20230221.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20230221.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20230207.0"
        base-image: "amazonlinux:2.0.20230207.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20230207.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20230207.0"
        base-image: "amazonlinux:2.0.20230207.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20230207.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20230119.1"
        base-image: "amazonlinux:2.0.20230119.1"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20230119.1"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20230119.1"
        base-image: "amazonlinux:2.0.20230119.1"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20230119.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20221210.0"
        base-image: "amazonlinux:2.0.20221210.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20221210.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20221210.0"
        base-image: "amazonlinux:2.0.20221210.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20221210.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20221103.3"
        base-image: "amazonlinux:2.0.20221103.3"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20221103.3"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20221103.3"
        base-image: "amazonlinux:2.0.20221103.3"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20221103.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20221004.0"
        base-image: "amazonlinux:2.0.20221004.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20221004.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20221004.0"
        base-image: "amazonlinux:2.0.20221004.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20221004.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20220912.1"
        base-image: "amazonlinux:2.0.20220912.1"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20220912.1"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20220912.1"
        base-image: "amazonlinux:2.0.20220912.1"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20220912.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20220805.0"
        base-image: "amazonlinux:2.0.20220805.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20220805.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20220805.0"
        base-image: "amazonlinux:2.0.20220805.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20220805.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20220719.0"
        base-image: "amazonlinux:2.0.20220719.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20220719.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20220719.0"
        base-image: "amazonlinux:2.0.20220719.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20220719.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20220606.1"
        base-image: "amazonlinux:2.0.20220606.1"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20220606.1"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20220606.1"
        base-image: "amazonlinux:2.0.20220606.1"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20220606.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20220426.0"
        base-image: "amazonlinux:2.0.20220426.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20220426.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20220426.0"
        base-image: "amazonlinux:2.0.20220426.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20220426.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20220419.0"
        base-image: "amazonlinux:2.0.20220419.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20220419.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20220419.0"
        base-image: "amazonlinux:2.0.20220419.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20220419.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20220406.1"
        base-image: "amazonlinux:2.0.20220406.1"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20220406.1"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20220406.1"
        base-image: "amazonlinux:2.0.20220406.1"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20220406.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20220316.0"
        base-image: "amazonlinux:2.0.20220316.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20220316.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20220316.0"
        base-image: "amazonlinux:2.0.20220316.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20220316.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20220218.1"
        base-image: "amazonlinux:2.0.20220218.1"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20220218.1"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20220218.1"
        base-image: "amazonlinux:2.0.20220218.1"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20220218.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on amazonlinux:2.0.20220121.0"
        base-image: "amazonlinux:2.0.20220121.0"
        build-image: "datadog/docker-library:nginx-datadog-build-amazonlinux_2.0.20220121.0"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on amazonlinux:2.0.20220121.0"
        base-image: "amazonlinux:2.0.20220121.0"
        nginx-modules-path: "/usr/share/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on amazonlinux:2.0.20220121.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.24.0-alpine"
        base-image: "nginx:1.24.0-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.24.0-alpine"
        nginx-version: "1.24.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
    - test:
        name: "test on nginx:1.24.0-alpine"
        base-image: "nginx:1.24.0-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.24.0-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
    - build:
        name: "build on nginx:1.24.0"
        base-image: "nginx:1.24.0"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.24.0"
        nginx-version: "1.24.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
    - test:
        name: "test on nginx:1.24.0"
        base-image: "nginx:1.24.0"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.24.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
    - build:
        name: "build on nginx:1.23.4-alpine"
        base-image: "nginx:1.23.4-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.23.4-alpine"
        nginx-version: "1.23.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.23.4-alpine"
        base-image: "nginx:1.23.4-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.23.4-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.23.4"
        base-image: "nginx:1.23.4"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.23.4"
        nginx-version: "1.23.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.23.4"
        base-image: "nginx:1.23.4"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.23.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.23.3-alpine"
        base-image: "nginx:1.23.3-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.23.3-alpine"
        nginx-version: "1.23.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.23.3-alpine"
        base-image: "nginx:1.23.3-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.23.3-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.23.3"
        base-image: "nginx:1.23.3"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.23.3"
        nginx-version: "1.23.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.23.3"
        base-image: "nginx:1.23.3"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.23.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.23.2-alpine"
        base-image: "nginx:1.23.2-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.23.2-alpine"
        nginx-version: "1.23.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.23.2-alpine"
        base-image: "nginx:1.23.2-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.23.2-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.23.2"
        base-image: "nginx:1.23.2"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.23.2"
        nginx-version: "1.23.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.23.2"
        base-image: "nginx:1.23.2"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.23.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.23.1-alpine"
        base-image: "nginx:1.23.1-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.23.1-alpine"
        nginx-version: "1.23.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.23.1-alpine"
        base-image: "nginx:1.23.1-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.23.1-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.23.1"
        base-image: "nginx:1.23.1"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.23.1"
        nginx-version: "1.23.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.23.1"
        base-image: "nginx:1.23.1"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.23.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.23.0-alpine"
        base-image: "nginx:1.23.0-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.23.0-alpine"
        nginx-version: "1.23.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.23.0-alpine"
        base-image: "nginx:1.23.0-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.23.0-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.23.0"
        base-image: "nginx:1.23.0"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.23.0"
        nginx-version: "1.23.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.23.0"
        base-image: "nginx:1.23.0"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.23.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.22.1-alpine"
        base-image: "nginx:1.22.1-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.22.1-alpine"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.22.1-alpine"
        base-image: "nginx:1.22.1-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.22.1-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.22.1"
        base-image: "nginx:1.22.1"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.22.1"
        nginx-version: "1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.22.1"
        base-image: "nginx:1.22.1"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.22.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.22.0-alpine"
        base-image: "nginx:1.22.0-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.22.0-alpine"
        nginx-version: "1.22.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.22.0-alpine"
        base-image: "nginx:1.22.0-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.22.0-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.22.0"
        base-image: "nginx:1.22.0"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.22.0"
        nginx-version: "1.22.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.22.0"
        base-image: "nginx:1.22.0"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.22.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.6-alpine"
        base-image: "nginx:1.21.6-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.6-alpine"
        nginx-version: "1.21.6"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.6-alpine"
        base-image: "nginx:1.21.6-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.6-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.6"
        base-image: "nginx:1.21.6"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.6"
        nginx-version: "1.21.6"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.6"
        base-image: "nginx:1.21.6"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.6"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.5-alpine"
        base-image: "nginx:1.21.5-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.5-alpine"
        nginx-version: "1.21.5"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.5-alpine"
        base-image: "nginx:1.21.5-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.5-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.5"
        base-image: "nginx:1.21.5"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.5"
        nginx-version: "1.21.5"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.5"
        base-image: "nginx:1.21.5"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.5"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.4-alpine"
        base-image: "nginx:1.21.4-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.4-alpine"
        nginx-version: "1.21.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.4-alpine"
        base-image: "nginx:1.21.4-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.4-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.4"
        base-image: "nginx:1.21.4"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.4"
        nginx-version: "1.21.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.4"
        base-image: "nginx:1.21.4"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.3-alpine"
        base-image: "nginx:1.21.3-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.3-alpine"
        nginx-version: "1.21.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.3-alpine"
        base-image: "nginx:1.21.3-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.3-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.3"
        base-image: "nginx:1.21.3"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.3"
        nginx-version: "1.21.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.3"
        base-image: "nginx:1.21.3"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.1-alpine"
        base-image: "nginx:1.21.1-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.1-alpine"
        nginx-version: "1.21.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.1-alpine"
        base-image: "nginx:1.21.1-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.1-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.1"
        base-image: "nginx:1.21.1"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.1"
        nginx-version: "1.21.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.1"
        base-image: "nginx:1.21.1"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.0-alpine"
        base-image: "nginx:1.21.0-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.0-alpine"
        nginx-version: "1.21.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.0-alpine"
        base-image: "nginx:1.21.0-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.0-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.21.0"
        base-image: "nginx:1.21.0"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.21.0"
        nginx-version: "1.21.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.21.0"
        base-image: "nginx:1.21.0"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.21.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.20.2-alpine"
        base-image: "nginx:1.20.2-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.20.2-alpine"
        nginx-version: "1.20.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.20.2-alpine"
        base-image: "nginx:1.20.2-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.20.2-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.20.2"
        base-image: "nginx:1.20.2"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.20.2"
        nginx-version: "1.20.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.20.2"
        base-image: "nginx:1.20.2"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.20.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.20.1-alpine"
        base-image: "nginx:1.20.1-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.20.1-alpine"
        nginx-version: "1.20.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.20.1-alpine"
        base-image: "nginx:1.20.1-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.20.1-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.20.1"
        base-image: "nginx:1.20.1"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.20.1"
        nginx-version: "1.20.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.20.1"
        base-image: "nginx:1.20.1"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.20.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.20.0-alpine"
        base-image: "nginx:1.20.0-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.20.0-alpine"
        nginx-version: "1.20.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.20.0-alpine"
        base-image: "nginx:1.20.0-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.20.0-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.20.0"
        base-image: "nginx:1.20.0"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.20.0"
        nginx-version: "1.20.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.20.0"
        base-image: "nginx:1.20.0"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.20.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.10-alpine"
        base-image: "nginx:1.19.10-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.10-alpine"
        nginx-version: "1.19.10"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.10-alpine"
        base-image: "nginx:1.19.10-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.10-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.10"
        base-image: "nginx:1.19.10"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.10"
        nginx-version: "1.19.10"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.10"
        base-image: "nginx:1.19.10"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.10"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.9-alpine"
        base-image: "nginx:1.19.9-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.9-alpine"
        nginx-version: "1.19.9"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.9-alpine"
        base-image: "nginx:1.19.9-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.9-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.9"
        base-image: "nginx:1.19.9"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.9"
        nginx-version: "1.19.9"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.9"
        base-image: "nginx:1.19.9"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.9"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.8-alpine"
        base-image: "nginx:1.19.8-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.8-alpine"
        nginx-version: "1.19.8"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.8-alpine"
        base-image: "nginx:1.19.8-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.8-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.8"
        base-image: "nginx:1.19.8"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.8"
        nginx-version: "1.19.8"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.8"
        base-image: "nginx:1.19.8"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.8"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.7-alpine"
        base-image: "nginx:1.19.7-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.7-alpine"
        nginx-version: "1.19.7"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.7-alpine"
        base-image: "nginx:1.19.7-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.7-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.7"
        base-image: "nginx:1.19.7"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.7"
        nginx-version: "1.19.7"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.7"
        base-image: "nginx:1.19.7"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.7"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.6-alpine"
        base-image: "nginx:1.19.6-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.6-alpine"
        nginx-version: "1.19.6"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.6-alpine"
        base-image: "nginx:1.19.6-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.6-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.6"
        base-image: "nginx:1.19.6"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.6"
        nginx-version: "1.19.6"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.6"
        base-image: "nginx:1.19.6"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.6"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.5-alpine"
        base-image: "nginx:1.19.5-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.5-alpine"
        nginx-version: "1.19.5"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.5-alpine"
        base-image: "nginx:1.19.5-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.5-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.5"
        base-image: "nginx:1.19.5"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.5"
        nginx-version: "1.19.5"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.5"
        base-image: "nginx:1.19.5"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.5"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.4-alpine"
        base-image: "nginx:1.19.4-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.4-alpine"
        nginx-version: "1.19.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.4-alpine"
        base-image: "nginx:1.19.4-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.4-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.4"
        base-image: "nginx:1.19.4"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.4"
        nginx-version: "1.19.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.4"
        base-image: "nginx:1.19.4"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.3-alpine"
        base-image: "nginx:1.19.3-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.3-alpine"
        nginx-version: "1.19.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.3-alpine"
        base-image: "nginx:1.19.3-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.3-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.3"
        base-image: "nginx:1.19.3"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.3"
        nginx-version: "1.19.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.3"
        base-image: "nginx:1.19.3"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.2-alpine"
        base-image: "nginx:1.19.2-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.2-alpine"
        nginx-version: "1.19.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.2-alpine"
        base-image: "nginx:1.19.2-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.2-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.2"
        base-image: "nginx:1.19.2"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.2"
        nginx-version: "1.19.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.2"
        base-image: "nginx:1.19.2"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.1-alpine"
        base-image: "nginx:1.19.1-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.1-alpine"
        nginx-version: "1.19.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.1-alpine"
        base-image: "nginx:1.19.1-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.1-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.1"
        base-image: "nginx:1.19.1"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.1"
        nginx-version: "1.19.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.1"
        base-image: "nginx:1.19.1"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.0-alpine"
        base-image: "nginx:1.19.0-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.0-alpine"
        nginx-version: "1.19.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.0-alpine"
        base-image: "nginx:1.19.0-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.0-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.19.0"
        base-image: "nginx:1.19.0"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.19.0"
        nginx-version: "1.19.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.19.0"
        base-image: "nginx:1.19.0"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.19.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.18.0-alpine"
        base-image: "nginx:1.18.0-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.18.0-alpine"
        nginx-version: "1.18.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.18.0-alpine"
        base-image: "nginx:1.18.0-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.18.0-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.18.0"
        base-image: "nginx:1.18.0"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.18.0"
        nginx-version: "1.18.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.18.0"
        base-image: "nginx:1.18.0"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.18.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.10-alpine"
        base-image: "nginx:1.17.10-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.10-alpine"
        nginx-version: "1.17.10"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.10-alpine"
        base-image: "nginx:1.17.10-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.10-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.10"
        base-image: "nginx:1.17.10"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.10"
        nginx-version: "1.17.10"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.10"
        base-image: "nginx:1.17.10"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.10"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.9-alpine"
        base-image: "nginx:1.17.9-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.9-alpine"
        nginx-version: "1.17.9"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.9-alpine"
        base-image: "nginx:1.17.9-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.9-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.9"
        base-image: "nginx:1.17.9"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.9"
        nginx-version: "1.17.9"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.9"
        base-image: "nginx:1.17.9"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.9"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.8-alpine"
        base-image: "nginx:1.17.8-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.8-alpine"
        nginx-version: "1.17.8"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.8-alpine"
        base-image: "nginx:1.17.8-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.8-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.8"
        base-image: "nginx:1.17.8"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.8"
        nginx-version: "1.17.8"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.8"
        base-image: "nginx:1.17.8"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.8"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.7-alpine"
        base-image: "nginx:1.17.7-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.7-alpine"
        nginx-version: "1.17.7"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.7-alpine"
        base-image: "nginx:1.17.7-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.7-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.7"
        base-image: "nginx:1.17.7"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.7"
        nginx-version: "1.17.7"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.7"
        base-image: "nginx:1.17.7"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.7"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.6-alpine"
        base-image: "nginx:1.17.6-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.6-alpine"
        nginx-version: "1.17.6"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.6-alpine"
        base-image: "nginx:1.17.6-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.6-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.6"
        base-image: "nginx:1.17.6"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.6"
        nginx-version: "1.17.6"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.6"
        base-image: "nginx:1.17.6"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.6"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.5-alpine"
        base-image: "nginx:1.17.5-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.5-alpine"
        nginx-version: "1.17.5"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.5-alpine"
        base-image: "nginx:1.17.5-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.5-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.5"
        base-image: "nginx:1.17.5"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.5"
        nginx-version: "1.17.5"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.5"
        base-image: "nginx:1.17.5"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.5"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.4-alpine"
        base-image: "nginx:1.17.4-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.4-alpine"
        nginx-version: "1.17.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.4-alpine"
        base-image: "nginx:1.17.4-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.4-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.4"
        base-image: "nginx:1.17.4"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.4"
        nginx-version: "1.17.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.4"
        base-image: "nginx:1.17.4"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.4"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.3-alpine"
        base-image: "nginx:1.17.3-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.3-alpine"
        nginx-version: "1.17.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.3-alpine"
        base-image: "nginx:1.17.3-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.3-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.3"
        base-image: "nginx:1.17.3"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.3"
        nginx-version: "1.17.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.3"
        base-image: "nginx:1.17.3"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.3"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.2-alpine"
        base-image: "nginx:1.17.2-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.2-alpine"
        nginx-version: "1.17.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.2-alpine"
        base-image: "nginx:1.17.2-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.2-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.2"
        base-image: "nginx:1.17.2"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.2"
        nginx-version: "1.17.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.2"
        base-image: "nginx:1.17.2"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.2"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.1-alpine"
        base-image: "nginx:1.17.1-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.1-alpine"
        nginx-version: "1.17.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.1-alpine"
        base-image: "nginx:1.17.1-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.1-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.1"
        base-image: "nginx:1.17.1"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.1"
        nginx-version: "1.17.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.1"
        base-image: "nginx:1.17.1"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.0-alpine"
        base-image: "nginx:1.17.0-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.0-alpine"
        nginx-version: "1.17.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.0-alpine"
        base-image: "nginx:1.17.0-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.0-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.17.0"
        base-image: "nginx:1.17.0"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.17.0"
        nginx-version: "1.17.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.17.0"
        base-image: "nginx:1.17.0"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.17.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.16.1-alpine"
        base-image: "nginx:1.16.1-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.16.1-alpine"
        nginx-version: "1.16.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.16.1-alpine"
        base-image: "nginx:1.16.1-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.16.1-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.16.1"
        base-image: "nginx:1.16.1"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.16.1"
        nginx-version: "1.16.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.16.1"
        base-image: "nginx:1.16.1"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.16.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.16.0-alpine"
        base-image: "nginx:1.16.0-alpine"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.16.0-alpine"
        nginx-version: "1.16.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.16.0-alpine"
        base-image: "nginx:1.16.0-alpine"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.16.0-alpine"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.16.0"
        base-image: "nginx:1.16.0"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.16.0"
        nginx-version: "1.16.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.16.0"
        base-image: "nginx:1.16.0"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.16.0"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - build:
        name: "build on nginx:1.14.1"
        base-image: "nginx:1.14.1"
        build-image: "datadog/docker-library:nginx-datadog-build-nginx_1.14.1"
        nginx-version: "1.14.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
    - test:
        name: "test on nginx:1.14.1"
        base-image: "nginx:1.14.1"
        nginx-modules-path: "/usr/lib/nginx/modules"
        nginx-conf-path: "/etc/nginx/nginx.conf"
        requires:
        - "build on nginx:1.14.1"
        filters:
          tags:
            only: /^v[0-9]+\.[0-9]+\.[0-9]+/
          branches:
            ignore: /.*/
