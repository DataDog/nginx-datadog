# Start nginx: `nginx -c conf/nginx.conf -p $(pwd)`
load_module ngx_http_datadog_module.so;

# daemon off;
worker_processes 1;
pid /tmp/nginx.pid;

events {
    worker_connections 1024;
}

error_log  logs/errors info;

http {
    access_log logs/access;

    server {
        listen 8080;

        datadog_rum on;
        datadog_rum_config "v5" {
          "applicationId" "foo";
          "clientToken" "bar";
        }

        root static;

        location / {
          index index.html index.htm;
          try_files $uri $uri/ @upstream_server;
        }

        location @upstream_server {
          proxy_pass http://localhost:8090;
        }
    }

    server {
        listen 8081;

        datadog_rum off;

        root static;

        location / {
          index index.html index.htm;
          try_files $uri $uri/ @upstream_server;
        }

        location @upstream_server {
          proxy_pass http://localhost:8090;
        }
    }
}

